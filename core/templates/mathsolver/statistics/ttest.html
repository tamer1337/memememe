{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-gray-50 py-8">
  <a href="{% url 'statistics' %}" class="fixed top-12 left-12 z-1 text-black-600 hover:text-gray-900 transition-colors">
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
    </svg>
  </a>

  <div class="max-w-4xl mx-auto px-4">
    <div class="text-center mb-10">
      <h1 class="text-3xl font-bold text-gray-800 mb-2">t-—Ç–µ—Å—Ç –°—Ç—å—é–¥–µ–Ω—Ç–∞ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫</h1>
      <p class="text-gray-600">–í–≤–µ–¥–∏—Ç–µ –¥–≤–∞ —Ä—è–¥–∞ —á–∏—Å–µ–ª —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, –±–µ–∑ –∑–∞–ø—è—Ç—ã—Ö</p>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md mb-6 space-y-4">
      <div>
        <label for="sample1" class="block text-sm font-medium text-gray-700 mb-1">–í—ã–±–æ—Ä–∫–∞ 1</label>
        <input type="text" id="sample1" class="w-full px-4 py-3 rounded-lg border border-gray-300" placeholder="–ü—Ä–∏–º–µ—Ä: 10 12 13 15 17">
      </div>
      <div>
        <label for="sample2" class="block text-sm font-medium text-gray-700 mb-1">–í—ã–±–æ—Ä–∫–∞ 2</label>
        <input type="text" id="sample2" class="w-full px-4 py-3 rounded-lg border border-gray-300" placeholder="–ü—Ä–∏–º–µ—Ä: 14 16 18 19 20">
      </div>
    </div>

    <div id="results" class="bg-white p-6 rounded-lg shadow-md space-y-4">
      <div><strong>–°—Ä–µ–¥–Ω–µ–µ –≤—ã–±–æ—Ä–∫–∏ 1 (ùë•ÃÑ‚ÇÅ):</strong> <span id="mean1">-</span></div>
      <div><strong>–°—Ä–µ–¥–Ω–µ–µ –≤—ã–±–æ—Ä–∫–∏ 2 (ùë•ÃÑ‚ÇÇ):</strong> <span id="mean2">-</span></div>
      <div><strong>–û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è (ùë†¬≤‚Çö):</strong> <span id="pooled">-</span></div>
      <div><strong>t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (t):</strong> <span id="tvalue">-</span></div>
      <div><strong>–°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã (df):</strong> <span id="df">-</span></div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md mt-6 space-y-4 text-sm text-gray-800 leading-relaxed">
      <h2 class="text-xl font-bold mb-2">–ß—Ç–æ —Ç–∞–∫–æ–µ t-—Ç–µ—Å—Ç?</h2>
      <p>t-—Ç–µ—Å—Ç –°—Ç—å—é–¥–µ–Ω—Ç–∞ ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –Ω–∏–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π.</p>

      <h2 class="text-xl font-bold mt-4 mb-2">–£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:</h2>
      <p>–î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–æ–≤—ã–º–∏, –≤—ã–±–æ—Ä–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏, –æ–±—ä—ë–º –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–∏ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ ‚â§ 30, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–Ω—ã.</p>

      <h2 class="text-xl font-bold mt-4 mb-2">–§–æ—Ä–º—É–ª—ã:</h2>
      <p><strong>–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</strong><br> 
      $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i$$</p>

      <p><strong>–î–∏—Å–ø–µ—Ä—Å–∏—è –≤—ã–±–æ—Ä–∫–∏:</strong><br>
      $$s^2 = \frac{1}{n - 1} \sum_{i=1}^n (x_i - \bar{x})^2$$</p>

      <p><strong>–û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è:</strong><br>
      $$s_p^2 = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}$$</p>

      <p><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥–Ω–∏—Ö:</strong><br>
      $$SE = \sqrt{s_p^2 \left( \frac{1}{n_1} + \frac{1}{n_2} \right)}$$</p>

      <p><strong>t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong><br>
      $$t = \frac{\bar{x}_1 - \bar{x}_2}{SE}$$</p>

      <p><strong>–°—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã:</strong><br>
      $$df = n_1 + n_2 - 2$$</p>

      <h2 class="text-xl font-bold mt-4 mb-2">–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:</h2>
      <p>–ß–µ–º –±–æ–ª—å—à–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ t, —Ç–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–∏–º–∞. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–ª–∏ –≤—ã—á–∏—Å–ª—è—é—Ç p-value.</p>
    </div>
  </div>
</div>

<script>
const input1 = document.getElementById('sample1');
const input2 = document.getElementById('sample2');
[input1, input2].forEach(input => input.addEventListener('input', calculateTTest));

function calculateTTest() {
  const raw1 = input1.value.trim().split(/\s+/).map(Number).filter(x => !isNaN(x));
  const raw2 = input2.value.trim().split(/\s+/).map(Number).filter(x => !isNaN(x));

  if (raw1.length < 2 || raw2.length < 2) return clearResults();

  const mean = arr => arr.reduce((a, b) => a + b, 0) / arr.length;
  const variance = (arr, m) => arr.reduce((acc, x) => acc + (x - m) ** 2, 0) / (arr.length - 1);

  const n1 = raw1.length;
  const n2 = raw2.length;
  const mean1 = mean(raw1);
  const mean2 = mean(raw2);
  const var1 = variance(raw1, mean1);
  const var2 = variance(raw2, mean2);

  const pooledVar = ((n1 - 1) * var1 + (n2 - 1) * var2) / (n1 + n2 - 2);
  const se = Math.sqrt(pooledVar * (1 / n1 + 1 / n2));
  const t = (mean1 - mean2) / se;
  const df = n1 + n2 - 2;

  document.getElementById('mean1').textContent = mean1.toFixed(6);
  document.getElementById('mean2').textContent = mean2.toFixed(6);
  document.getElementById('pooled').textContent = pooledVar.toFixed(6);
  document.getElementById('tvalue').textContent = t.toFixed(6);
  document.getElementById('df').textContent = df;
}

function clearResults() {
  document.getElementById('mean1').textContent = '-';
  document.getElementById('mean2').textContent = '-';
  document.getElementById('pooled').textContent = '-';
  document.getElementById('tvalue').textContent = '-';
  document.getElementById('df').textContent = '-';
}
</script>
{% endblock %}
